(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{17:function(e,t,n){e.exports=n(40)},40:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),l=n(15),o=n.n(l),c=n(16),u=n(1),i=n.n(u),s=n(2),m=n(4),d=function(e){var t=e.marginBottom,n=e.color,r=e.label,l=e.id,o=e.className,c=e.handleClick,u={fontSize:"&#10003;"===r?"20px":"15px",borderRadius:6,borderColor:"white",backgroundColor:n,textDecoration:"none",color:"#ffffff",marginBottom:t};return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{style:u,onClick:c,id:l,className:o},r))},p=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),l=Object(m.a)(n,2),o=l[0],c=l[1],u={display:o?"":"none"},i=function(){return c(!o)},s=o?e.labelOne:e.labelTwo;return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),a.a.createElement("div",null,a.a.createElement("div",{style:u,className:"hideOrShow"}," ",e.children," "),a.a.createElement(d,{handleClick:i,label:s,className:e.className,color:o?"orange":"#008CBA",marginBottom:10}))}));p.displayName="ToggleVisibility";var f,g=p,b=function(e){var t=e.blog,n=e.loggedUser,r=e.modifyBlog,l=e.handleBlogDeletion,o=function(){return window.confirm("Remove blog '".concat(t.title,"' by ").concat(t.author))?l(t.id):null};return a.a.createElement("div",{className:"blogs",style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},a.a.createElement("div",{className:"blog-title"},t.title," ",t.author),a.a.createElement(g,{labelOne:"hide",labelTwo:"view",className:"toggle"},a.a.createElement("div",{className:"blog-url"}," ",t.url),a.a.createElement("div",null,"likes ",a.a.createElement("span",{id:"num-of-likes"},t.likes),a.a.createElement(d,{handleClick:function(){return r(t)},label:"like",color:"green",id:"like-blog"})),a.a.createElement("div",null," ",t.author),function(){if(t.user.username===n)return a.a.createElement(d,{handleClick:o,label:"delete",id:"delete-blog",color:"#f44336"})}()))},v=function(e){var t=e.addBlog,n=Object(r.useState)(""),l=Object(m.a)(n,2),o=l[0],c=l[1],u=Object(r.useState)(""),i=Object(m.a)(u,2),s=i[0],p=i[1],f=Object(r.useState)(""),g=Object(m.a)(f,2),b=g[0],v=g[1];return a.a.createElement("div",{style:{marginBottom:5}},a.a.createElement("h2",null,"Create New Blog"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:o,author:s,url:b}),c(""),p(""),v("")}},a.a.createElement("div",null,a.a.createElement("label",null,"Title",a.a.createElement("input",{onChange:function(e){var t=e.target;return c(t.value)},value:o,type:"text",name:"title",autoComplete:"on"}))),a.a.createElement("div",null,a.a.createElement("label",null,"Author",a.a.createElement("input",{onChange:function(e){var t=e.target;return p(t.value)},value:s,type:"text",name:"author",autoComplete:"name"}))),a.a.createElement("div",null,a.a.createElement("label",null,"Url",a.a.createElement("input",{onChange:function(e){var t=e.target;return v(t.value)},value:b,type:"url",name:"url",autoComplete:"url"}))),a.a.createElement(d,{label:"create",color:"green",id:"post-blog"})))},h=function(e){var t=e.login,n=Object(r.useState)(""),l=Object(m.a)(n,2),o=l[0],c=l[1],u=Object(r.useState)(""),i=Object(m.a)(u,2),s=i[0],p=i[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Log in to application"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:o,password:s}),c(""),p("")}},a.a.createElement("div",null,a.a.createElement("label",null,"Username",a.a.createElement("input",{onChange:function(e){var t=e.target;return c(t.value)},value:o,type:"text",name:"username",autoComplete:"username"}))),a.a.createElement("div",null,a.a.createElement("label",null,"Password",a.a.createElement("input",{onChange:function(e){var t=e.target;return p(t.value)},value:s,type:"password",name:"password",autoComplete:"currnt-password"}))),a.a.createElement(d,{label:"log in",color:"green"})))},E=function(e){var t=e.noticeToUser;if(null===t)return null;var n={color:t.code?"green":"red",fontSize:26,padding:5,border:"0.1em solid",borderRadius:5,marginTop:10,marginBottom:10,backgroundColor:"#F0F0F0"};return a.a.createElement("div",{className:"notice",style:n},t.message)},w=n(5),k=n.n(w),x={getAll:function(){return k.a.get("/api/blogs").then((function(e){return e.data}))},createBlog:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("/api/blogs",t,{headers:{Authorization:f}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateBlog:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.put("".concat("/api/blogs","/").concat(n),t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){return f="bearer ".concat(e)},deleteBlog:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.delete("".concat("/api/blogs","/").concat(t),{headers:{Authorization:f}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O={login:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j={getUser:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("".concat("/api/users","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=function(){var e=Object(r.useState)([]),t=Object(m.a)(e,2),n=t[0],l=t[1],o=Object(r.useState)(null),u=Object(m.a)(o,2),p=u[0],f=u[1],w=Object(r.useState)(null),k=Object(m.a)(w,2),y=k[0],B=k[1],C=Object(r.useRef)();Object(r.useEffect)((function(){x.getAll().then((function(e){return l(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedInUser");if(e){var t=JSON.parse(e);f(t),x.setToken(t.token)}}),[]);var S=n.concat().sort((function(e,t){return e.likes-t.likes})).reverse(),T=function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B({message:t,code:n}),e.next=3,setTimeout((function(){return B(null)}),5e3);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(n)),x.setToken(n.token),f(n),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log("login error",e.t0.response.data.error),e.next=14,T("Wrong password or username",0);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(s.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C.current.toggleVisibility(),e.next=4,x.createBlog(t);case 4:return r=e.sent,e.next=7,j.getUser(r.user);case 7:return a=e.sent,r.user=a,l(n.concat(r)),e.next=12,T("A new blog '".concat(r.title,"' has been added!"),1);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(0),console.log("blog creation failed",e.t0.response.data.error),e.next=19,T("".concat(e.t0.response.data.error),0);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(s.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={user:t.user.id,title:t.title,author:t.author,likes:t.likes+=1},e.next=4,x.updateBlog(r,t.id);case 4:return a=e.sent,l(n.map((function(e){return e.id!==t.id?e:Object(c.a)({},a,{user:a.user=t.user})}))),e.next=8,T("Thanks for liking the post, '".concat(a.title,"'!"),1);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("error",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.deleteBlog(t);case 3:if(r=e.sent,console.log("res",r),204!==r.status){e.next=9;break}return l(n.filter((function(e){return e.id!==t}))),e.next=9,T("Blog deletion successful'!",1);case 9:e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("error",e.t0),e.next=16,T("Deletion failed: ".concat(e.t0.response.data.error,"'!"),1);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return null===p?a.a.createElement("div",null,a.a.createElement(E,{noticeToUser:y}),a.a.createElement(h,{login:N})):a.a.createElement("div",null,a.a.createElement(E,{noticeToUser:y}),a.a.createElement("h2",null,"blogs"),a.a.createElement("p",null,p.name," is logged in",a.a.createElement(d,{handleClick:function(){f(null),window.localStorage.removeItem("loggedInUser")},label:"logout",color:"grey"})),a.a.createElement(g,{ref:C,labelOne:"cancel",labelTwo:"create blog"},a.a.createElement(v,{addBlog:U})),S.map((function(e){return a.a.createElement(b,{key:e.id,blog:e,loggedUser:p.username,handleBlogDeletion:A,modifyBlog:I})})))};o.a.render(a.a.createElement(y,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.56592cdb.chunk.js.map