(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{80:function(e,t,r){"use strict";r.r(t);var n,c=r(0),a=r.n(c),s=r(22),o=r.n(s),u=r(21),i=r(29),l=r(7),d=r(46),j=r(47),b=r(3),p=r.n(b),O=r(6),f=r(8),v=function(e,t){return function(){var r=Object(O.a)(p.a.mark((function r(n){return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n({type:"SET_NOTICE",message:e,code:t}),r.next=3,new Promise((function(){setTimeout((function(){n({type:"RESET_NOTICE"})}),5e3)}));case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTICE":return Object(f.a)({},t);case"RESET_NOTICE":return null;default:return e}},g=r(23),x=r(19),m=r.n(x),w="/api/blogs",y={getAll:function(){var e=Object(O.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(w);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createBlog:function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(w,t,{headers:{Authorization:n}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateBlog:function(){var e=Object(O.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.put("".concat(w,"/").concat(r),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),setToken:function(e){return n="bearer ".concat(e)},deleteBlog:function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.delete("".concat(w,"/").concat(t),{headers:{Authorization:n}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createComment:function(){var e=Object(O.a)(p.a.mark((function e(t,r){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("".concat(w,"/").concat(r,"/comments"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},k="/api/users",E={getUsers:function(){var e=Object(O.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat(k));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getUser:function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat(k,"/").concat(t));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createUser:function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(k,t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S={login:function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post("/api/login",t);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(e){return function(){var t=Object(O.a)(p.a.mark((function t(r){var n,c,a,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null===e||void 0===e?void 0:e.token){t.next=7;break}return t.next=4,S.login(e);case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0=null;case 8:(c=t.t0)&&window.localStorage.setItem("currentUser",JSON.stringify(c)),y.setToken(null!==(n=null===c||void 0===c?void 0:c.token)&&void 0!==n?n:null===e||void 0===e?void 0:e.token),r({type:"SET_CURRENT_USER",currentUser:null!==c&&void 0!==c?c:e}),t.next=18;break;case 14:t.prev=14,t.t1=t.catch(0),console.log("login error",t.t1),r(v(null===t.t1||void 0===t.t1||null===(a=t.t1.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error,0));case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()},T=r(10),B=r(5),U=r(1),_=function(e){var t=e.type,r=e.sortby,n=e.children,c=Object(l.c)((function(e){return("users"===t?e[t][t]:e[t]).concat().sort((function(e,n){return e[r]-("users"===t?n.blogs.length:n[r])})).reverse()}));return Object(U.jsxs)("div",{children:["users"===t&&Object(U.jsxs)("div",{children:[Object(U.jsx)("h2",{children:"Users"})," ",Object(U.jsx)("h4",{style:{marginLeft:"18%"},children:"Blogs Created"})]}),null===c||void 0===c?void 0:c.map((function(e){return a.a.Children.map(n,(function(t){return a.a.cloneElement(t,{data:e,key:e.id})}))}))]})},R=function(e){var t=e.marginBottom,r=e.color,n=e.label,c=e.id,a=e.className,s=e.handleClick,o={borderRadius:4,borderColor:"white",backgroundColor:r,textDecoration:"none",color:"#ffffff",marginBottom:t};return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)("button",{style:o,onClick:s,id:c,className:a,children:n})})},L=function(e){var t=e.toggleForm,r=Object(l.b)(),n=Object(c.useState)(""),a=Object(T.a)(n,2),s=a[0],o=a[1],u=Object(c.useState)(""),i=Object(T.a)(u,2),d=i[0],j=i[1],b=Object(c.useState)(""),f=Object(T.a)(b,2),h=f[0],g=f[1],x=Object(B.f)();return Object(U.jsxs)("div",{style:{marginBottom:5},children:[Object(U.jsx)("h2",{children:"Create New Blog"}),Object(U.jsxs)("form",{onSubmit:function(e){var n;e.preventDefault(),t.current.toggleVisibility(),r((n={title:s,author:d,url:h},function(){var e=Object(O.a)(p.a.mark((function e(t){var r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.createBlog(n);case 3:return r=e.sent,e.next=6,E.getUser(r.user);case 6:c=e.sent,r.user=c,t({type:"NEW_BLOG",newBlog:r}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("blog creation failed",e.t0.response.data.error),t(v("blog creation failed: ".concat(e.t0.response.data.error),0));case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}())),r(v("A new blog '".concat(s,"' has been added!"),1)),o(""),j(""),g(""),x.push("/")},children:[Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Title",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return o(t.value)},value:s,type:"text",name:"title",autoComplete:"on"})]})}),Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Author",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return j(t.value)},value:d,type:"text",name:"author",autoComplete:"name"})]})}),Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Url",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return g(t.value)},value:h,type:"url",name:"url",autoComplete:"url"})]})}),Object(U.jsx)(R,{label:"create",color:"green",id:"post-blog"})]})]})},N=function(){console.log("lg",0);var e=Object(l.b)(),t=Object(l.c)((function(e){return e.toggle})),r=Object(c.useState)(""),n=Object(T.a)(r,2),a=n[0],s=n[1],o=Object(c.useState)(""),u=Object(T.a)(o,2),i=u[0],d=u[1];return Object(U.jsxs)("div",{style:{display:t?"none":""},children:[Object(U.jsx)("h2",{children:"Log in to application"}),Object(U.jsxs)("form",{onSubmit:function(t){console.log("lg",1),t.preventDefault(),e(C({username:a,password:i})),console.log("lg",2),s(""),d("")},children:[Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Username",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return s(t.value)},value:a,type:"text",name:"username",autoComplete:"username"})]})}),Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Password",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return d(t.value)},value:i,type:"password",name:"password",autoComplete:"currnt-password"})]})}),Object(U.jsx)(R,{label:"log in",color:"green"})]})]})},G=function(){var e=Object(l.c)((function(e){return e.notice}));if(null===e)return null;var t={color:e.code?"green":"red",fontSize:26,padding:5,border:"0.1em solid",borderRadius:5,marginTop:10,marginBottom:10,backgroundColor:"#F0F0F0"};return Object(U.jsx)("div",{className:"notice",style:t,children:e.message})},I=a.a.forwardRef((function(e,t){var r=Object(l.b)(),n=Object(c.useState)(!1),a=Object(T.a)(n,2),s=a[0],o=a[1],u={display:s?"":"none"},i=s?e.labelOne:e.labelTwo,d=function(){"Sign in"!==i&&"Register"!==i||r("Register"===i?{type:"TOGGLE"}:{type:"RESET_TOGGLE"}),o(!s)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),Object(U.jsxs)("div",{children:[Object(U.jsxs)("div",{style:u,className:"hideOrShow",children:[" ",e.children," "]}),Object(U.jsx)(R,{handleClick:d,label:i,className:e.className,color:s?"orange":"#008CBA",marginBottom:10})]})}));I.displayName="ToggleVisibility";var A=I,D=function(){var e=Object(l.b)(),t=Object(c.useState)(""),r=Object(T.a)(t,2),n=r[0],a=r[1],s=Object(c.useState)(""),o=Object(T.a)(s,2),u=o[0],i=o[1],d=Object(c.useState)(""),j=Object(T.a)(d,2),b=j[0],f=j[1];return Object(U.jsxs)("div",{style:{marginBottom:5},children:[Object(U.jsx)("h2",{children:"Register"}),Object(U.jsxs)("form",{onSubmit:function(t){var r;t.preventDefault(),e((r={username:n,name:u,password:b},function(){var e=Object(O.a)(p.a.mark((function e(t){var n,c,a,s,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.createUser(r);case 3:(n=e.sent)&&(t(C({username:n.username,password:r.password})),t({type:"ADD_USER",newUser:n})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("sign up error",e.t0),(null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c||null===(a=c.data)||void 0===a?void 0:a.error)&&t(v(null===e.t0||void 0===e.t0||null===(s=e.t0.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.error,0));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),a(""),i(""),f("")},children:[Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Username",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return a(t.value)},value:n,type:"text",name:"userName",autoComplete:"on",required:!0})]})}),Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Name",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return i(t.value)},value:u,type:"text",name:"name",autoComplete:"name"})]})}),Object(U.jsx)("div",{children:Object(U.jsxs)("label",{children:["Password",Object(U.jsx)("input",{onChange:function(e){var t=e.target;return f(t.value)},value:b,type:"password",name:"passwd",autoComplete:"password",required:!0})]})}),Object(U.jsx)(R,{label:"Sign Up",color:"green",id:"add-user"})]})]})},F=r(97),M=r(98),J=function(e){var t=e.data;return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(F.a,{button:!0,component:u.b,to:"/blogs/".concat(t.id),children:Object(U.jsx)(M.a,{primary:t.title,secondary:t.author})})})},q=function(e){var t=e.data,r={padding:5};return Object(U.jsxs)("div",{style:{paddingTop:10,paddingLeft:2,marginBottom:5,width:"20%"},children:[Object(U.jsx)("span",{style:r,children:Object(U.jsx)(u.c,{to:"/users/".concat(t.id),children:t.name})}),Object(U.jsx)("span",{style:Object(f.a)(Object(f.a)({},r),{},{textAlign:"center",float:"right"}),children:t.blogs.length})]})},z=function(e){var t=e.user;return t?Object(U.jsxs)("div",{children:[Object(U.jsxs)("h2",{children:[" ",t.name," "]}),Object(U.jsx)("h4",{children:" Added Blogs"}),Object(U.jsx)("ul",{children:t.blogs.map((function(e){return Object(U.jsxs)("li",{children:[" ",e.title," "]},t.id)}))})]}):null},P=function(e){var t=e.blogId,r=Object(l.b)(),n=Object(c.useState)(""),a=Object(T.a)(n,2),s=a[0],o=a[1];return Object(U.jsx)("div",{children:Object(U.jsx)("form",{onSubmit:function(e){e.preventDefault(),r(function(e,t){return function(){var r=Object(O.a)(p.a.mark((function r(n){var c;return p.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y.createComment(e,t);case 3:c=r.sent,n({type:"COMMENT_ON_BLOG",commentedBlog:c}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.error("error",r.t0.message);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(e){return r.apply(this,arguments)}}()}({content:s},t)),o("")},children:Object(U.jsxs)("div",{children:[Object(U.jsx)("input",{onChange:function(e){var t=e.target;return o(t.value)},value:s,type:"text",name:"username",required:!0,placeholder:"enter your comment"}),Object(U.jsx)(R,{label:"Add Comment",color:"green"})]})})})},V=function(e){var t,r=e.blog,n=Object(l.b)(),c=Object(l.c)((function(e){return e.users.currentUser})),a=Object(B.f)(),s=function(){var e;window.confirm("Remove blog '".concat(null===r||void 0===r?void 0:r.title,"' by ").concat(null===r||void 0===r?void 0:r.author))&&(n((e=null===r||void 0===r?void 0:r.id,function(){var t=Object(O.a)(p.a.mark((function t(r){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.deleteBlog(e);case 3:n=t.sent,console.log("res",n),204===n.status&&(r({type:"DELETE_BLOG",id:e}),r(v("blog successfully deleted?",1))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("error",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}())),a.push("/"))};return r?Object(U.jsxs)("div",{children:[Object(U.jsxs)("h2",{children:[" ",r.title,", ",r.author]}),Object(U.jsxs)("h4",{children:[" ",Object(U.jsx)(u.b,{to:{pathname:r.url},target:"_blank",children:r.url})," "]}),Object(U.jsxs)("ul",{children:[Object(U.jsxs)("li",{children:["likes ",Object(U.jsx)("span",{id:"num-of-likes",children:r.likes})]}),Object(U.jsxs)("li",{children:["added by ",null===(t=r.user)||void 0===t?void 0:t.name," "]})]}),Object(U.jsxs)("div",{children:[Object(U.jsx)(R,{handleClick:function(){var e;n(function(e){return function(){var t=Object(O.a)(p.a.mark((function t(r){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.updateBlog(e,e.id);case 3:(n=t.sent).user=e.user,r({type:"LIKE_BLOG",likedBlog:n}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("error",t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(Object(f.a)(Object(f.a)({},r),{},{user:null===r||void 0===r||null===(e=r.user)||void 0===e?void 0:e.id,likes:r.likes+=1}))),window.location.reload()},label:"like",color:"green",id:"like-blog"}),function(){var e;if((null===r||void 0===r||null===(e=r.user)||void 0===e?void 0:e.username)===c.username)return console.log("user",c),console.log("user2",r.user),Object(U.jsx)(R,{handleClick:s,label:"delete",id:"delete-blog",color:"#f44336"})}()]}),Object(U.jsx)("h3",{children:"Comments"}),Object(U.jsx)(P,{blogId:r.id}),function(){var e;return null===r||void 0===r||null===(e=r.comments)||void 0===e?void 0:e.map((function(e){return Object(U.jsx)("ul",{children:Object(U.jsx)("li",{children:e.content})},e.id)}))}()]}):null},W=r(96),K=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return[e.users.currentUser,e.users.users,e.blogs]})),r=Object(T.a)(t,3),n=r[0],a=r[1],s=r[2],o=Object(B.g)("/users/:id"),i=Object(B.g)("/blogs/:id"),d=Object(c.useRef)();Object(c.useEffect)((function(){e(function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:r=e.sent,t({type:"BLOGS",blogs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(function(){var e=Object(O.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.getUsers();case 3:r=e.sent,t({type:"SET_USERS",users:r}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("get users error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(c.useEffect)((function(){var t=window.localStorage.getItem("currentUser");t&&e(C(JSON.parse(t)))}),[e]);var j=function(e,t){return e&&t.find((function(t){return t.id===e.params.id}))};return n?Object(U.jsxs)(W.a,{children:[Object(U.jsxs)("div",{children:[Object(U.jsx)(u.c,{to:"/",children:"Blogs"}),Object(U.jsx)(u.c,{to:"/users",children:"Users"}),n.name," is logged in",Object(U.jsx)(R,{handleClick:function(){e(function(){var e=Object(O.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.localStorage.removeItem("currentUser");case 2:t({type:"LOGOUT_USER"}),t({type:"RESET_TOGGLE"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},label:"logout",color:"grey"})]}),Object(U.jsx)(G,{}),Object(U.jsx)("h2",{children:"blogs"}),Object(U.jsx)(A,{ref:d,labelOne:"cancel",labelTwo:"create blog",children:Object(U.jsx)(L,{toggleForm:d})}),Object(U.jsxs)(B.c,{children:[Object(U.jsx)(B.a,{path:"/users/:id",children:Object(U.jsx)(z,{user:j(o,a)})}),Object(U.jsx)(B.a,{path:"/blogs/:id",children:Object(U.jsx)(V,{blog:j(i,s)})}),Object(U.jsx)(B.a,{path:"/users",children:Object(U.jsx)(_,{type:"users",sortby:"numberOfBlogs",children:Object(U.jsx)(q,{})})}),Object(U.jsx)(B.a,{path:"/",children:Object(U.jsx)(_,{type:"blogs",sortby:"likes",children:Object(U.jsx)(J,{})})})]})]}):Object(U.jsxs)(W.a,{children:[Object(U.jsx)(G,{}),Object(U.jsx)(N,{}),Object(U.jsx)(A,{labelOne:"Sign in",labelTwo:"Register",children:Object(U.jsx)(D,{})})]})},H=Object(i.combineReducers)({notice:h,blogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BLOGS":return t.blogs;case"NEW_BLOG":return[].concat(Object(g.a)(e),[t.newBlog]);case"LIKE_BLOG":return e.map((function(e){return e.id!==t.likedBlog.id?e:Object(f.a)({},t.likedBlog)}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.id}));case"COMMENT_ON_BLOG":return e.map((function(e){return e.id!==t.commentedBlog.id?e:Object(f.a)({},t.commentedBlog)}));default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{users:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(f.a)(Object(f.a)({},e),{},{currentUser:t.currentUser});case"SET_USERS":return Object(f.a)(Object(f.a)({},e),{},{users:t.users});case"LOGOUT_USER":return Object(f.a)(Object(f.a)({},e),{},{currentUser:null});case"ADD_USER":return Object(f.a)(Object(f.a)({},e),{},{users:[].concat(Object(g.a)(e.users),[t.newUser])});default:return e}},toggle:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE":return!0;case"RESET_TOGGLE":return!1;default:return e}}}),Q=Object(i.createStore)(H,Object(j.composeWithDevTools)(Object(i.applyMiddleware)(d.a)));o.a.render(Object(U.jsx)(u.a,{children:Object(U.jsx)(l.a,{store:Q,children:Object(U.jsx)(K,{})})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.a9478bfd.chunk.js.map